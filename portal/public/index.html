<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mini PaaS Portal</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=Space+Grotesk:wght@500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles.css?v=20260208">
</head>
<body>
  <div class="mesh-layer" aria-hidden="true">
    <span class="orb orb-a"></span>
    <span class="orb orb-b"></span>
    <span class="orb orb-c"></span>
  </div>

  <header id="gnb" class="gnb" aria-label="메인 네비게이션">
    <div class="gnb-left">
      <a class="gnb-brand" href="/" aria-label="Mini PaaS Portal">
        <span class="gnb-logo" aria-hidden="true">P</span>
        <span class="gnb-brand-text">
          <span class="eyebrow">Mini PaaS</span>
          <strong>Portal</strong>
        </span>
      </a>
      <nav class="gnb-nav">
        <button class="gnb-item active" type="button" data-view="dashboard">
          <svg class="gnb-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/></svg>
          <span>대시보드</span>
        </button>
        <button class="gnb-item" type="button" data-view="create">
          <svg class="gnb-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
          <span>앱 생성</span>
        </button>
        <button class="gnb-item" type="button" data-view="ops">
          <svg class="gnb-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M19.14 12.94a7.8 7.8 0 0 0 .05-.94 7.8 7.8 0 0 0-.05-.94l2.03-1.58a.5.5 0 0 0 .12-.64l-1.92-3.32a.5.5 0 0 0-.6-.22l-2.39.96a7.2 7.2 0 0 0-1.62-.94l-.36-2.54a.5.5 0 0 0-.5-.42h-3.84a.5.5 0 0 0-.5.42l-.36 2.54a7.2 7.2 0 0 0-1.62.94l-2.39-.96a.5.5 0 0 0-.6.22L2.71 8.84a.5.5 0 0 0 .12.64l2.03 1.58a7.8 7.8 0 0 0-.05.94 7.8 7.8 0 0 0 .05.94l-2.03 1.58a.5.5 0 0 0-.12.64l1.92 3.32a.5.5 0 0 0 .6.22l2.39-.96c.5.39 1.04.7 1.62.94l.36 2.54a.5.5 0 0 0 .5.42h3.84a.5.5 0 0 0 .5-.42l.36-2.54c.58-.24 1.12-.55 1.62-.94l2.39.96a.5.5 0 0 0 .6-.22l1.92-3.32a.5.5 0 0 0-.12-.64l-2.03-1.58Z"/></svg>
          <span>운영 센터</span>
        </button>
        <button id="gnb-users-btn" class="gnb-item" type="button" data-view="users" hidden>
          <svg class="gnb-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M16 11c1.66 0 2.99-1.57 2.99-3.5S17.66 4 16 4s-3 1.57-3 3.5S14.34 11 16 11zm-8 0c1.66 0 2.99-1.57 2.99-3.5S9.66 4 8 4 5 5.57 5 7.5 6.34 11 8 11zm0 2c-2.33 0-7 1.17-7 3.5V20h14v-3.5C15 14.17 10.33 13 8 13zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.94 1.97 3.45V20h6v-3.5c0-2.33-4.67-3.5-7-3.5z"/></svg>
          <span>유저 관리</span>
        </button>
      </nav>
      <button id="mobile-menu-btn" class="icon-btn gnb-hamburger" type="button" aria-label="메뉴">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
      </button>
    </div>
    <div class="gnb-right">
      <p id="auth-state" class="auth-state">로그아웃 상태</p>
      <button id="settings-btn" class="icon-btn" type="button" aria-label="설정" hidden>
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M19.14 12.94a7.8 7.8 0 0 0 .05-.94 7.8 7.8 0 0 0-.05-.94l2.03-1.58a.5.5 0 0 0 .12-.64l-1.92-3.32a.5.5 0 0 0-.6-.22l-2.39.96a7.2 7.2 0 0 0-1.62-.94l-.36-2.54a.5.5 0 0 0-.5-.42h-3.84a.5.5 0 0 0-.5.42l-.36 2.54a7.2 7.2 0 0 0-1.62.94l-2.39-.96a.5.5 0 0 0-.6.22L2.71 8.84a.5.5 0 0 0 .12.64l2.03 1.58a7.8 7.8 0 0 0-.05.94 7.8 7.8 0 0 0 .05.94l-2.03 1.58a.5.5 0 0 0-.12.64l1.92 3.32a.5.5 0 0 0 .6.22l2.39-.96c.5.39 1.04.7 1.62.94l.36 2.54a.5.5 0 0 0 .5.42h3.84a.5.5 0 0 0 .5-.42l.36-2.54c.58-.24 1.12-.55 1.62-.94l2.39.96a.5.5 0 0 0 .6-.22l1.92-3.32a.5.5 0 0 0-.12-.64l-2.03-1.58Z"/></svg>
      </button>
      <button id="logout-btn" class="ghost-btn gnb-logout-btn" type="button" hidden>로그아웃</button>
    </div>
  </header>

  <div class="app-layout">
    <main class="main-content">
      <p id="status-banner" class="status-banner info">세션 확인 중...</p>

      <section id="view-dashboard" class="view-section">
        <header class="view-header">
          <h2>대시보드</h2>
          <p class="view-subtitle">배포된 앱 현황을 확인합니다.</p>
        </header>
        <div class="dashboard-stats">
          <div class="chip">
            <span class="chip-label">PAAS_DOMAIN</span>
            <strong id="domain-chip">-</strong>
          </div>
          <div class="chip">
            <span class="chip-label">Limit</span>
            <strong id="limit-chip">-</strong>
          </div>
          <div class="chip">
            <span class="chip-label">Apps</span>
            <strong id="app-count-chip">0</strong>
          </div>
        </div>
        <section class="panel app-panel">
          <div class="panel-head">
            <h3>배포된 앱</h3>
            <button id="refresh-btn" class="ghost-btn" type="button">새로고침</button>
          </div>
          <p id="empty-state" class="empty-state">앱이 없습니다. 먼저 앱을 생성하세요.</p>
          <div id="apps-container" class="apps-container"></div>
        </section>
      </section>

      <section id="view-create" class="view-section" hidden>
        <header class="view-header">
          <h2>앱 생성</h2>
          <p class="view-subtitle">새 앱을 생성하고 배포합니다.</p>
        </header>
        <article class="panel create-panel">
          <form id="create-form" novalidate>
            <label for="userid-input">User ID</label>
            <input id="userid-input" name="userid" type="text" placeholder="alice" required>

            <label for="appname-input">App Name</label>
            <input id="appname-input" name="appname" type="text" placeholder="diary" required>

            <label for="template-input">Template ID</label>
            <input id="template-input" name="templateId" type="text" value="diary-v1" required>

            <label class="checkbox-row" for="enable-api-input">
              <input id="enable-api-input" name="enableApi" type="checkbox" checked>
              <span>SQLite API 활성화</span>
            </label>

            <p class="preview-text">
              예상 주소:
              <code id="domain-preview">userid-appname.my.domain.com</code>
            </p>

            <button class="primary-btn" type="submit">Create App</button>
          </form>
        </article>
      </section>

      <section id="view-ops" class="view-section" hidden>
        <header class="view-header">
          <h2>운영 센터</h2>
          <p class="view-subtitle">앱 운영 설정 및 로그를 확인합니다.</p>
        </header>
        <article class="panel ops-panel">
          <div class="tab-row" role="tablist" aria-label="운영 센터 탭">
            <button id="tab-btn-ops" class="tab-btn active" type="button" data-tab-target="ops" role="tab" aria-selected="true" aria-controls="tab-ops">운영 설정</button>
            <button id="tab-btn-logs" class="tab-btn" type="button" data-tab-target="logs" role="tab" aria-selected="false" aria-controls="tab-logs">로그</button>
          </div>

          <section id="tab-ops" class="tab-panel" role="tabpanel" aria-labelledby="tab-btn-ops">
            <label class="field-label" for="log-lines-input">로그 조회 라인 수</label>
            <input id="log-lines-input" type="number" min="1" max="1000" value="120">

            <label class="checkbox-row" for="keep-data-input">
              <input id="keep-data-input" type="checkbox" checked>
              <span>삭제 시 data 폴더 보존</span>
            </label>

            <section id="password-required-note" class="control-section warning-section" hidden>
              <h3>비밀번호 변경 필요</h3>
              <p>초기 비밀번호를 변경해야 앱 관리 기능이 활성화됩니다.</p>
              <button id="open-settings-btn" class="ghost-btn" type="button">설정 열기</button>
            </section>

            <section id="api-keys-panel" class="control-section" hidden>
              <h3>API Key 관리</h3>
              <form id="create-api-key-form" novalidate>
                <label for="api-key-name-input">키 이름</label>
                <input id="api-key-name-input" type="text" placeholder="deploy-bot" maxlength="60">
                <button id="create-api-key-btn" class="ghost-btn" type="submit">새 키 발급</button>
              </form>
              <p class="preview-text">
                새 키:
                <code id="new-api-key">(없음)</code>
              </p>
              <div id="api-key-list" class="api-key-list"></div>
            </section>
          </section>

          <section id="tab-logs" class="tab-panel" role="tabpanel" aria-labelledby="tab-btn-logs" hidden>
            <div class="panel-head logs-head">
              <h3>로그</h3>
              <span id="logs-title">앱을 선택하면 로그가 표시됩니다.</span>
            </div>
            <pre id="logs-output">No logs yet.</pre>
          </section>
        </article>
      </section>

      <section id="view-users" class="view-section" hidden>
        <header class="view-header">
          <h2>유저 관리</h2>
          <p class="view-subtitle">username, 권한, 가입일자, 접속일자를 확인합니다.</p>
        </header>
        <article class="panel users-panel">
          <div class="panel-head">
            <h3>사용자 목록</h3>
            <div class="users-head-actions">
              <span id="users-count" class="users-count">0명</span>
              <button id="open-create-user-btn" class="ghost-btn users-add-btn" type="button">추가</button>
            </div>
          </div>
          <p id="users-empty-state" class="empty-state">등록된 사용자가 없습니다.</p>
          <div class="users-table-wrap">
            <table class="users-table">
              <thead>
                <tr>
                  <th scope="col">username</th>
                  <th scope="col">admin 권한 여부</th>
                  <th scope="col">가입일자</th>
                  <th scope="col">접속일자</th>
                  <th scope="col">제거</th>
                </tr>
              </thead>
              <tbody id="users-table-body"></tbody>
            </table>
          </div>
        </article>
      </section>
    </main>
  </div>

  <div id="gnb-mobile-overlay" class="gnb-mobile-overlay" aria-hidden="true"></div>

  <div id="settings-modal" class="modal-backdrop" hidden>
    <section class="modal-card panel-inset" role="dialog" aria-modal="true" aria-labelledby="settings-title">
      <div class="modal-head">
        <h2 id="settings-title">설정</h2>
        <button id="close-settings-btn" class="icon-btn close-icon-btn" type="button" aria-label="설정 닫기">
          <span aria-hidden="true">x</span>
        </button>
      </div>
      <p class="modal-description">비밀번호를 변경할 수 있습니다.</p>
      <p id="settings-error" class="modal-error" role="alert" hidden></p>
      <form id="password-form" novalidate>
        <label for="current-password-input">현재 비밀번호</label>
        <input id="current-password-input" type="password" autocomplete="current-password" required>
        <label for="new-password-input">새 비밀번호 (8자 이상)</label>
        <input id="new-password-input" type="password" autocomplete="new-password" required>
        <button id="change-password-btn" class="primary-btn" type="submit">비밀번호 변경</button>
      </form>
    </section>
  </div>

  <div id="create-user-modal" class="modal-backdrop" hidden>
    <section class="modal-card panel-inset" role="dialog" aria-modal="true" aria-labelledby="create-user-title">
      <div class="modal-head">
        <h2 id="create-user-title">유저 추가</h2>
        <button id="close-create-user-btn" class="icon-btn close-icon-btn" type="button" aria-label="유저 추가 닫기">
          <span aria-hidden="true">x</span>
        </button>
      </div>
      <p class="modal-description">새 계정을 생성합니다. username은 소문자 영문/숫자 3~20자 형식입니다.</p>
      <p id="create-user-error" class="modal-error" role="alert" hidden></p>
      <form id="create-user-form" novalidate>
        <label for="create-username-input">username</label>
        <input
          id="create-username-input"
          type="text"
          placeholder="alice"
          autocomplete="username"
          maxlength="20"
          required
        >
        <label for="create-password-input">password</label>
        <input
          id="create-password-input"
          type="password"
          placeholder="8자 이상 비밀번호"
          autocomplete="new-password"
          required
        >
        <label for="create-password-confirm-input">password confirm</label>
        <input
          id="create-password-confirm-input"
          type="password"
          placeholder="비밀번호를 다시 입력하세요"
          autocomplete="new-password"
          required
        >
        <label for="create-user-role-input">권한</label>
        <select id="create-user-role-input">
          <option value="user">일반 사용자</option>
          <option value="admin">관리자</option>
        </select>
        <div class="modal-actions">
          <button id="cancel-create-user-btn" class="ghost-btn" type="button">취소</button>
          <button id="submit-create-user-btn" class="primary-btn" type="submit">확인</button>
        </div>
      </form>
    </section>
  </div>

  <div id="delete-user-modal" class="modal-backdrop" hidden>
    <section class="modal-card panel-inset" role="dialog" aria-modal="true" aria-labelledby="delete-user-title">
      <div class="modal-head">
        <h2 id="delete-user-title">사용자 제거</h2>
        <button id="close-delete-user-btn" class="icon-btn close-icon-btn" type="button" aria-label="사용자 제거 닫기">
          <span aria-hidden="true">x</span>
        </button>
      </div>
      <p id="delete-user-target" class="modal-description">삭제할 사용자를 확인하세요.</p>
      <p class="modal-description">현재 로그인한 admin 비밀번호를 입력해야 제거할 수 있습니다.</p>
      <p id="delete-user-error" class="modal-error" role="alert" hidden></p>
      <form id="delete-user-form" novalidate>
        <label for="delete-user-password-input">현재 admin 비밀번호</label>
        <input
          id="delete-user-password-input"
          type="password"
          placeholder="현재 로그인한 admin 비밀번호"
          autocomplete="current-password"
          required
        >
        <div class="modal-actions">
          <button id="cancel-delete-user-btn" class="ghost-btn" type="button">취소</button>
          <button id="submit-delete-user-btn" class="action-btn danger" type="submit">제거</button>
        </div>
      </form>
    </section>
  </div>

  <script src="./app.js?v=20260208"></script>
</body>
</html>
