<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mini PaaS Portal</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=Space+Grotesk:wght@500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <div class="mesh-layer" aria-hidden="true">
    <span class="orb orb-a"></span>
    <span class="orb orb-b"></span>
    <span class="orb orb-c"></span>
  </div>

  <div class="page">
    <header class="topbar panel">
      <div class="topbar-copy">
        <p class="eyebrow">Mini PaaS Control Plane</p>
        <h1>Portal Dashboard</h1>
        <p class="subtitle">템플릿 선택부터 운영까지 한 화면에서 끝내는 초보 친화형 배포 콘솔</p>
      </div>
      <div class="topbar-actions">
        <p id="auth-state" class="auth-state">로그아웃 상태</p>
        <button id="settings-btn" class="icon-btn" type="button" aria-label="설정" hidden>
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M19.14 12.94a7.8 7.8 0 0 0 .05-.94 7.8 7.8 0 0 0-.05-.94l2.03-1.58a.5.5 0 0 0 .12-.64l-1.92-3.32a.5.5 0 0 0-.6-.22l-2.39.96a7.2 7.2 0 0 0-1.62-.94l-.36-2.54a.5.5 0 0 0-.5-.42h-3.84a.5.5 0 0 0-.5.42l-.36 2.54a7.2 7.2 0 0 0-1.62.94l-2.39-.96a.5.5 0 0 0-.6.22L2.71 8.84a.5.5 0 0 0 .12.64l2.03 1.58a7.8 7.8 0 0 0-.05.94 7.8 7.8 0 0 0 .05.94l-2.03 1.58a.5.5 0 0 0-.12.64l1.92 3.32a.5.5 0 0 0 .6.22l2.39-.96c.5.39 1.04.7 1.62.94l.36 2.54a.5.5 0 0 0 .5.42h3.84a.5.5 0 0 0 .5-.42l.36-2.54c.58-.24 1.12-.55 1.62-.94l2.39.96a.5.5 0 0 0 .6-.22l1.92-3.32a.5.5 0 0 0-.12-.64l-2.03-1.58ZM12 15.2a3.2 3.2 0 1 1 0-6.4 3.2 3.2 0 0 1 0 6.4Z"/>
          </svg>
        </button>
        <button id="logout-btn" class="ghost-btn" type="button" hidden>로그아웃</button>
      </div>
    </header>

    <p id="status-banner" class="status-banner info">세션 확인 중...</p>

    <section id="dashboard-view" class="dashboard-view">
      <section class="layout-grid">
        <article class="panel create-panel">
          <div class="panel-head">
            <h2>앱 생성</h2>
          </div>
          <form id="create-form" novalidate>
            <label for="userid-input">User ID</label>
            <input id="userid-input" name="userid" type="text" placeholder="alice" required>

            <label for="appname-input">App Name</label>
            <input id="appname-input" name="appname" type="text" placeholder="diary" required>

            <label for="template-input">Template ID</label>
            <input id="template-input" name="templateId" type="text" value="diary-v1" required>

            <label class="checkbox-row" for="enable-api-input">
              <input id="enable-api-input" name="enableApi" type="checkbox" checked>
              <span>SQLite API 활성화</span>
            </label>

            <p class="preview-text">
              예상 주소:
              <code id="domain-preview">userid-appname.my.domain.com</code>
            </p>

            <button class="primary-btn" type="submit">Create App</button>
          </form>
        </article>

        <article class="panel middle-panel">
          <div class="panel-head">
            <h2>운영 센터</h2>
          </div>

          <div class="tab-row" role="tablist" aria-label="운영 센터 탭">
            <button id="tab-btn-ops" class="tab-btn active" type="button" data-tab-target="ops" role="tab" aria-selected="true" aria-controls="tab-ops">운영 설정</button>
            <button id="tab-btn-logs" class="tab-btn" type="button" data-tab-target="logs" role="tab" aria-selected="false" aria-controls="tab-logs">로그</button>
          </div>

          <section id="tab-ops" class="tab-panel" role="tabpanel" aria-labelledby="tab-btn-ops">
            <div class="chip-grid">
              <div class="chip">
                <span class="chip-label">PAAS_DOMAIN</span>
                <strong id="domain-chip">-</strong>
              </div>
              <div class="chip">
                <span class="chip-label">Limit</span>
                <strong id="limit-chip">-</strong>
              </div>
              <div class="chip">
                <span class="chip-label">Apps</span>
                <strong id="app-count-chip">0</strong>
              </div>
            </div>

            <label class="field-label" for="log-lines-input">로그 조회 라인 수</label>
            <input id="log-lines-input" type="number" min="1" max="1000" value="120">

            <label class="checkbox-row" for="keep-data-input">
              <input id="keep-data-input" type="checkbox" checked>
              <span>삭제 시 data 폴더 보존</span>
            </label>

            <button id="refresh-btn" class="ghost-btn" type="button">목록 새로고침</button>

            <section id="password-required-note" class="control-section warning-section" hidden>
              <h3>비밀번호 변경 필요</h3>
              <p>초기 비밀번호를 변경해야 앱 관리 기능이 활성화됩니다.</p>
              <button id="open-settings-btn" class="ghost-btn" type="button">설정 열기</button>
            </section>

            <section id="api-keys-panel" class="control-section" hidden>
              <h3>API Key 관리</h3>
              <form id="create-api-key-form" novalidate>
                <label for="api-key-name-input">키 이름</label>
                <input id="api-key-name-input" type="text" placeholder="deploy-bot" maxlength="60">
                <button id="create-api-key-btn" class="ghost-btn" type="submit">새 키 발급</button>
              </form>
              <p class="preview-text">
                새 키:
                <code id="new-api-key">(없음)</code>
              </p>
              <div id="api-key-list" class="api-key-list"></div>
            </section>
          </section>

          <section id="tab-logs" class="tab-panel" role="tabpanel" aria-labelledby="tab-btn-logs" hidden>
            <div class="panel-head logs-head">
              <h3>로그</h3>
              <span id="logs-title">앱을 선택하면 로그가 표시됩니다.</span>
            </div>
            <pre id="logs-output">No logs yet.</pre>
          </section>
        </article>
      </section>

      <section class="panel app-panel">
        <div class="panel-head">
          <h2>배포된 앱</h2>
        </div>
        <p id="empty-state" class="empty-state">앱이 없습니다. 먼저 앱을 생성하세요.</p>
        <div id="apps-container" class="apps-container"></div>
      </section>
    </section>
  </div>

  <div id="settings-modal" class="modal-backdrop" hidden>
    <section class="modal-card panel-inset" role="dialog" aria-modal="true" aria-labelledby="settings-title">
      <div class="modal-head">
        <h2 id="settings-title">설정</h2>
        <button id="close-settings-btn" class="icon-btn close-icon-btn" type="button" aria-label="설정 닫기">
          <span aria-hidden="true">x</span>
        </button>
      </div>
      <p class="modal-description">비밀번호를 변경할 수 있습니다.</p>
      <p id="settings-error" class="modal-error" role="alert" hidden></p>
      <form id="password-form" novalidate>
        <label for="current-password-input">현재 비밀번호</label>
        <input id="current-password-input" type="password" autocomplete="current-password" required>
        <label for="new-password-input">새 비밀번호 (8자 이상)</label>
        <input id="new-password-input" type="password" autocomplete="new-password" required>
        <button id="change-password-btn" class="primary-btn" type="submit">비밀번호 변경</button>
      </form>
    </section>
  </div>

  <script src="./app.js"></script>
</body>
</html>
